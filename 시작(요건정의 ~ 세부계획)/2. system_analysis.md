# 수창_엑셀 취합프로그램 시스템 분석서

## 1. 업무 프로세스 분석

### 1.1 현재 업무 프로세스 (AS-IS)
```
👤 사용자 → 📁 파일1 열기 → 📋 데이터 복사 → 📁 통합파일 → 📋 붙여넣기
    ↓
👤 사용자 → 📁 파일2 열기 → 📋 데이터 복사 → 📁 통합파일 → 📋 붙여넣기
    ↓
👤 사용자 → 📁 파일3 열기 → 📋 데이터 복사 → 📁 통합파일 → 📋 붙여넣기
    ↓
👤 사용자 → ✏️ 서식 수동 통일 → 💾 저장

문제점:
- 반복적 수작업 (시간 소모)
- 서식 불일치 (품질 문제)
- 실수 가능성 높음 (정확성 문제)
- 대량 파일 처리 한계
```

### 1.2 개선된 업무 프로세스 (TO-BE)
```
👤 사용자 → 🎯 원본파일 선택 → 📁 취합파일들 선택 → ⚙️ 설정 → 🚀 자동처리 → 💾 결과저장

개선효과:
- 수작업 90% 감소
- 서식 자동 통일
- 실수 방지
- 대량 처리 가능
```

## 2. 데이터 흐름 분석 (Data Flow Analysis)

### 2.1 전체 데이터 흐름
```
[원본 데이터 파일] ────────┐
                        │
                    [서식 기준 추출]
                        │
                        ↓
[취합 파일 1] ────┐      │
[취합 파일 2] ────┤  [데이터 읽기] ────→ [정규화 처리] ────→ [병합 처리]
[취합 파일 N] ────┘      ↑                              │
                        │                              ↓
                   [진행상황 피드백] ←────────────── [통합 파일 생성]
```

### 2.2 세부 데이터 처리 과정

#### 2.2.1 서식 기준 추출 과정
```
원본 파일 → 시트별 분석 → 열별 데이터 타입 분석 → 서식 정보 추출
    │           │              │                   │
    │           │              │                   ├─ 숫자 서식 (천단위, 소수점)
    │           │              │                   ├─ 날짜 서식 (yyyy-mm-dd)
    │           │              │                   └─ 텍스트 서식 (정렬, 띄어쓰기)
    │           │              │
    │           │              ├─ 숫자형 데이터 패턴
    │           │              ├─ 날짜형 데이터 패턴  
    │           │              └─ 텍스트형 데이터 패턴
    │           │
    │           ├─ 시트명 목록
    │           ├─ 열제목 위치 및 내용
    │           └─ 데이터 시작 행
    │
    └─ 파일 메타정보
```

#### 2.2.2 취합 파일 처리 과정
```
각 취합파일 → 시트명 매칭 → 열제목 매칭 → 데이터 정규화 → 병합 대기열
     │           │            │             │             │
     │           │            │             │             └─ 통합 데이터 구조
     │           │            │             │
     │           │            │             ├─ 서식 변환 로그
     │           │            │             ├─ 데이터 정제 로그
     │           │            │             └─ 변환된 데이터
     │           │            │
     │           │            ├─ 열 순서 매핑 정보
     │           │            └─ 누락 열 처리 방안
     │           │
     │           ├─ 유사도 80% 이상 → 동일 시트 판정
     │           └─ 신규 시트 → 새 시트로 분류
     │
     └─ 파일별 처리 상태
```

## 3. 사용자 시나리오 분석

### 3.1 주요 사용자 시나리오

#### 시나리오 1: 정상적인 병합 처리
```
사전조건: 서식이 일관된 엑셀 파일들 보유

1. 사용자가 프로그램 실행
2. 원본 데이터 파일을 드래그앤드롭으로 추가
3. 취합할 파일들을 다중 선택으로 추가
4. "고속 병합 시작" 버튼 클릭
5. 진행률 바에서 처리 상황 확인
6. 완료 후 결과 파일 저장 위치 선택
7. 변경사항 요약 보고서 확인

결과: 서식이 통일된 통합 엑셀 파일 생성
```

#### 시나리오 2: 서식 불일치 파일 처리
```
사전조건: 서로 다른 서식의 엑셀 파일들 보유

1-3. (시나리오 1과 동일)
4. 서식 불일치 경고 메시지 표시
5. 사용자가 "자동 서식 통일" 옵션 선택
6. 시스템이 원본 기준으로 서식 자동 변환
7. 변경사항이 비고열에 상세 기록
8. (이후 시나리오 1과 동일)

결과: 서식 통일 + 변경 이력이 포함된 통합 파일
```

#### 시나리오 3: 유사 시트명 처리
```
사전조건: 시트명이 유사하지만 정확히 일치하지 않는 파일들

예시 시트명: "매출 데이터", "매출데이터", "매출_데이터"

1-3. (시나리오 1과 동일)
4. 시스템이 시트명 유사도 분석
5. 80% 이상 유사한 시트들을 그룹화
6. 사용자에게 통합 여부 확인 요청
7. 사용자 승인 후 통합 처리
8. 원본 시트명을 비고열에 기록

결과: 유사 시트가 통합된 파일 + 원본 정보 보존
```

### 3.2 예외 상황 시나리오

#### 예외 시나리오 1: 손상된 파일 처리
```
문제상황: 일부 엑셀 파일이 손상되어 읽을 수 없음

1. 시스템이 파일 읽기 시도
2. 손상된 파일 감지
3. 오류 메시지와 함께 해당 파일명 표시
4. 사용자에게 선택 옵션 제공:
   - 손상된 파일 제외하고 계속 진행
   - 전체 작업 중단
5. 사용자 선택에 따라 처리 계속

처리방안: 손상된 파일 목록 로그 생성
```

#### 예외 시나리오 2: 메모리 부족 상황
```
문제상황: 대용량 파일로 인한 메모리 부족

1. 시스템이 메모리 사용량 모니터링
2. 임계값(400MB) 도달 시 경고
3. 청크 단위 처리 모드로 자동 전환
4. 처리 속도는 느려지지만 안정적으로 완료

처리방안: 적응형 메모리 관리
```

#### 예외 시나리오 3: 열제목 매칭 실패
```
문제상황: 파일별로 열제목이 너무 달라서 자동 매칭 불가

1. 시스템이 열제목 유사도 분석
2. 70% 미만 유사도인 열들 감지
3. 매칭 실패 열 목록을 사용자에게 표시
4. 사용자가 수동으로 매칭 관계 설정
5. 설정된 매핑 규칙으로 처리 진행

처리방안: 대화형 열 매핑 인터페이스
```

## 4. 시스템 경계 분석

### 4.1 시스템 내부 (In Scope)
```
✅ 엑셀 파일 읽기/쓰기
✅ 데이터 정규화 및 서식 통일
✅ 시트/열 자동 매칭
✅ 사용자 인터페이스
✅ 진행상황 모니터링
✅ 오류 처리 및 로깅
```

### 4.2 시스템 외부 (Out of Scope)
```
❌ 다른 파일 형식 지원 (CSV, TXT 등)
❌ 클라우드 저장소 연동
❌ 웹 기반 인터페이스
❌ 데이터베이스 연동
❌ 실시간 협업 기능
❌ 버전 관리 시스템
```

### 4.3 외부 시스템과의 인터페이스
```
🔗 운영체제: 파일 시스템 접근
🔗 Excel 애플리케이션: 파일 형식 호환성
🔗 사용자: GUI를 통한 상호작용
```

## 5. 데이터 모델 분석

### 5.1 핵심 데이터 엔티티
```
📊 SourceFile (원본 파일)
├─ file_path: 파일 경로
├─ sheets: 시트 목록
├─ format_standards: 서식 기준 정보
└─ metadata: 파일 메타데이터

📊 MergeFile (취합 파일)
├─ file_path: 파일 경로
├─ sheets: 시트 목록
├─ processing_status: 처리 상태
└─ error_log: 오류 로그

📊 Sheet (시트)
├─ name: 시트명
├─ header_row: 헤더 행 번호
├─ columns: 열 정보 목록
└─ data_rows: 데이터 행 목록

📊 Column (열)
├─ name: 열명
├─ data_type: 데이터 타입
├─ format_info: 서식 정보
└─ position: 열 위치

📊 ProcessingLog (처리 로그)
├─ file_name: 파일명
├─ change_type: 변경 유형
├─ original_value: 원본 값
├─ converted_value: 변환된 값
└─ timestamp: 처리 시간
```

### 5.2 데이터 관계
```
SourceFile 1:N Sheet
MergeFile 1:N Sheet
Sheet 1:N Column
Sheet 1:N ProcessingLog
```

## 6. 프로세스 흐름 분석

### 6.1 초기화 프로세스
```
프로그램 시작 → GUI 초기화 → 설정 로드 → 대기 상태
```

### 6.2 파일 처리 프로세스
```
파일 선택 → 유효성 검사 → 메타데이터 추출 → 미리보기 생성 → 처리 대기
```

### 6.3 병합 실행 프로세스
```
시작 요청 → 서식 기준 설정 → 파일별 처리 → 데이터 통합 → 결과 저장 → 완료 보고
```

## 7. 성능 요구사항 분석

### 7.1 처리량 분석
```
목표: 10,000행/5분 = 2,000행/분 = 33행/초

병목 구간 분석:
- 파일 I/O: 가장 큰 병목 (SSD 기준 최적화)
- 서식 변환: CPU 집약적 (멀티스레딩으로 해결)
- 메모리 접근: 청크 단위 처리로 최적화
```

### 7.2 메모리 사용 패턴
```
기본 프로그램: 50MB
파일 당 평균: 5MB (10,000행 기준)
최대 동시 처리: 10개 파일 = 50MB
안전 마진: 350MB
총 메모리 한계: 500MB
```

## 8. 위험 요소 분석

### 8.1 기술적 위험
```
🔴 높음: 대용량 파일 메모리 오버플로우
🟡 중간: 다양한 엑셀 버전 호환성 문제
🟢 낮음: GUI 응답성 문제
```

### 8.2 사용자 위험
```
🔴 높음: 잘못된 파일 선택으로 인한 데이터 손실
🟡 중간: 복잡한 인터페이스로 인한 사용 어려움
🟢 낮음: 결과 파일 저장 위치 혼동
```

### 8.3 완화 방안
```
✅ 자동 백업 기능
✅ 단계별 진행 확인
✅ 명확한 오류 메시지
✅ 실행 취소 기능
```

이제 시스템 분석이 완료되었습니다. 다음 단계는 **시스템 설계(System Design)**입니다.